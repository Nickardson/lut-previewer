<div class="app-container">
  <app-image-drop (files)="imagesDropped($event)" class="app-preview">
    <div class="image-preview">
      <!-- <div class="image-preview-side">
        <app-image-processor *ngIf="imageData" [highQuality]="true" [imageData]="imageData"></app-image-processor>
        Before
      </div> -->
      <div class="image-preview-side">
        <app-image-processor #main [highQuality]="true" [imageData]="imageData" [showOriginal]="showOriginal"
          [lut]="lutData">
        </app-image-processor>
        <app-image-processor #lut [style.max-width]="getLutMaxWidth()"
          [style.display]="lutData && lutData.height < lutData.width ? 'inherit' : 'none'" [requireLut]="false"
          [highQuality]="true" [imageData]="lutData"></app-image-processor>

        <div class="lut-bar">
          <span class="lut-name">{{lutName || 'Unchanged'}}</span>
          <span class="lut-actions">
            <a href="#" (click)="main.save((imageName || 'image') + '-' + (lutName || 'lut'), 'png')">Save .png</a>
            <a href="#" (click)="main.save((imageName || 'image') + '-' + (lutName || 'lut'), 'jpg')">Save .jpg</a>
            <a href="#" (click)="lut.save(lutName || 'lut', 'png')">Save LUT</a>

            <span (mouseleave)="showOriginal = false" (mousedown)="showOriginal = true" (mouseup)="showOriginal = false"
              (touchstart)="showOriginal = true" (touchend)="showOriginal = false" class="show-original"
              [class.show-original--useless]="!lutData" title="Hold to show Original">
              <svg style="width:48px;height:48px" viewBox="0 0 24 24">
                <path fill="currentColor"
                  d="M15 21H17V19H15M19 9H21V7H19M3 5V19C3 20.1 3.9 21 5 21H9V19H5V5H9V3H5C3.9 3 3 3.9 3 5M19 3V5H21C21 3.9 20.1 3 19 3M11 23H13V1H11M19 17H21V15H19M15 5H17V3H15M19 13H21V11H19M19 21C20.1 21 21 20.1 21 19H19Z" />
              </svg>
            </span>
          </span>
        </div>

        <h2 class="drop-prompt">
          Drag-and-drop an image to preview here, or<br />
          <input type="file" (change)="imagesSelected($any($event.target).files)" />
        </h2>
      </div>
    </div>
  </app-image-drop>

  <app-image-drop (files)="lutsDropped($event)" class="app-luts">
    <app-lut-selector [image]="imageDataSmall" [luts]="luts" (lutSelected)="lutSelected($event)"></app-lut-selector>

    <h2 class="drop-prompt">
      Drag-and-drop .png file LUTs to preview here, or<br />
      <input type="file" multiple (change)="lutsSelected($any($event.target).files)" accept="image/*" />
    </h2>
    <br />
    <a *ngIf="luts.length > 1" href="#" (click)="clearLuts()">Clear LUT list</a>
  </app-image-drop>
</div>

<!-- TODO: credit sources -->